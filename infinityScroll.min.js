/**
* Infinity Scroll
* @author Carlos Vinicius
* @version 3.1
* @date 2012-12-20
*/
"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});
(function(g){jQuery.fn.infinityScroll=function(r){var p,d,c,a,f,q,e,l,j,h;d=function(a,b){"object"==typeof console&&console.log("!\n[Infinity Scroll - "+(b||"Erro")+"] "+a)};p={lastShelf:">div:last",elemLoading:'<div id="scrollLoading">Carregando ... </div>',searchUrl:null,returnToTop:g('<div id="returnToTop"><a href="#"><span class="text">voltar ao</span><span class="text2">TOPO</span><span class="arrowToTop"></span></a></div>'),callback:function(){},getShelfHeight:function(){return a.scrollTop()+
a.height()},paginate:null,insertContent:function(a,b){a.after(b)}};c=jQuery.extend({},p,r);a=jQuery(this);jQuery("");if(1>a.length)return a;1<a.length&&(d("Identifiquei que a seletor informado ("+a.selector+") retornou "+a.length+" elementos.\n Como correto, selecionado o primeiro com o id: #"+(a.filter("[id^=ResultItems]:first").attr("id")||"!Not Found"),"Aviso"),a=a.filter("[id^=ResultItems]:first"));a.filter("[id^=ResultItems]").length||d("Certifique-se que esta selecionando o elemento correto.\n O plugin espera que o elemento seja o que cont\u00e9m o id: #"+
jQuery("div[id^=ResultItems]").attr("id")||"!Not Found","Aviso");a.parent().filter("[id^=ResultItems]").length&&(d("Identifiquei que o seletor pai do elemento que voc\u00ea informou \u00e9 o #"+(jQuery("div[id^=ResultItems]").attr("id")||"!Not Found")+".\n Como forma de corrigir esse problema de sele\u00e7\u00e3o de elemento, assumirei prateleira correta.","Aviso"),a=a.parent());g("body").append(c.returnToTop);f=jQuery(window);q=jQuery(document);e=g(c.returnToTop);l=jQuery(c.elemLoading);j=!0;h=2;
var n={scrollToTop:function(){var a=f.height();f.bind("resize",function(){a=f.height()});f.bind("scroll",function(){q.scrollTop()>a?e.stop(!0).fadeTo(300,1,function(){e.show()}):e.stop(!0).fadeTo(300,0,function(){e.hide()})});e.find("a").bind("click",function(){jQuery("html,body").animate({scrollTop:0},"slow");return!1})},getSearchUrl:function(){var a,b,c;jQuery("script:not([src])").each(function(){b=jQuery(this)[0].innerHTML;c=/\/buscapagina\?.+&PageNumber=/i;if(-1<b.search(/\/buscapagina\?/i))return a=
c.exec(b),!1});if("undefined"!==typeof a&&"undefined"!==typeof a[0])return a[0];d("N\u00e3o foi poss\u00edvel localizar a url de busca da p\u00e1gina.\n Tente adicionar o .js ao final da p\u00e1gina. \n[M\u00e9todo: getSearchUrl]");return""},infinityScroll:function(){var e,b,g,k,m;g=null!==c.searchUrl?c.searchUrl:n.getSearchUrl();k=!0;b=9999999999999;e=jQuery(".pager[id*=PagerTop]:first").attr("id")||"";""===e?d("N\u00e3o foi poss\u00edvel localizar o div.pages contendo o atributo id*=PagerTop","Alerta"):
(b=window["pagecount_"+e.split("_").pop()],"undefined"===typeof b&&d("N\u00e3o foi poss\u00edvel localizar quantidade de p\u00e1ginas.\n Tente adicionar o .js ao final da p\u00e1gina. \n[M\u00e9todo: infinityScroll]"));m=function(){if(k){var b=a.find(c.lastShelf);if(1>b.length)return d("\u00daltima Prateleira/Vitrine n\u00e3o encontrada \n ("+b.selector+")"),!1;b.after(l);k=!1;jQuery.ajax({url:g+h,success:function(a){1>a.trim().length?(j=!1,d("N\u00e3o existem mais resultados a partir da p\u00e1gina: "+
h,"Aviso")):c.insertContent(b,a);k=!0;l.remove()},error:function(){d("Houve um erro na requisi\u00e7\u00e3o Ajax de uma nova p\u00e1gina.")},complete:function(){c.callback()}});h++}};"function"===typeof c.paginate?c.paginate(function(){h<=b&&j&&m()}):f.bind("scroll",function(){if(h<=b&&j)f.scrollTop()+f.height()>=c.getShelfHeight()&&m();else return!1})}};n.scrollToTop();n.infinityScroll();return a}})(jQuery);
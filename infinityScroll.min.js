/**
* Infinity Scroll
* @author Carlos Vinicius
* @version 2.3
* @date 2012-08-07
*/
"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});
jQuery.fn.infinityScroll=function(g){var e=jQuery.extend({toTop:"#returnToTop",lastShelf:".prateleira:last",elemLoading:'<div id="scrollLoading">Carregando ... </div>',searchUrl:null,callback:function(){},getShelfHeight:function(){return c.scrollTop()+c.height()}},g),c=jQuery(this);jQuery("");var f="object"===typeof console;if(1>c.length)return c;var b=$(window),m=$(document),j=$("body"),d=j.find(e.toTop),k=jQuery(e.elemLoading),l=!0;currentPage=2;var h={scrollToTop:function(){var a=b.height();b.bind("resize",
function(){a=b.height()});b.bind("scroll",function(){m.scrollTop()>a?d.stop(!0).fadeTo(300,1,function(){d.show()}):d.stop(!0).fadeTo(300,0,function(){d.hide()})});d.find("a").bind("click",function(){jQuery("html,body").animate({scrollTop:0},"slow");return!1})},getSearchUrl:function(){var a,b,c;jQuery("script:not([src])").each(function(){b=jQuery(this)[0].innerHTML;c=/\/buscapagina\?.+&PageNumber=/i;if(-1<b.search(/\/buscapagina\?/i))return a=c.exec(b),!1});if("undefined"!==typeof a&&"undefined"!==
typeof a[0])return a[0];f&&console.log("[Erro] N\u00e3o foi poss\u00edvel localizar a url de busca da p\u00e1gina.\n Tente adicionar o .js ao final da p\u00e1gina. \n[M\u00e9todo: getSearchUrl]");return""},infinityScroll:function(){var a=j.find(".pager[id*=PagerTop]:first").attr("id")||"";if(""===a)return f&&console.log("[Erro] N\u00e3o foi poss\u00edvel localizar o div.pages contendo o atributo id*=PagerTop"),"";var d=eval("pagecount_"+a.split("_").pop()),g=null!==e.searchUrl?e.searchUrl:h.getSearchUrl(),
i=!0;"undefined"===typeof d&&console.log("[Erro] N\u00e3o foi poss\u00edvel localizar quantidade de p\u00e1ginas.\n Tente adicionar o .js ao final da p\u00e1gina. \n[M\u00e9todo: infinityScroll]");b.bind("scroll",function(){if(currentPage<=d&&l){if(b.scrollTop()+b.height()>=e.getShelfHeight()&&i){var a=c.find(e.lastShelf);if(1>a.length)return f&&console.log("[Erro] \u00daltima Prateleira/Vitrine n\u00e3o encontrada \n ("+a.selector+")"),!1;a.after(k);i=!1;jQuery.ajax({url:g+currentPage,success:function(b){1>
b.trim().length?(l=!1,f&&console.log("[Aviso] N\u00e3o existem mais resultados a partir da p\u00e1gina: "+currentPage)):a.after(b);i=!0;k.remove()},error:function(){f&&console.log("[Error] Houve um erro na requisi\u00e7\u00e3o Ajax de uma nova p\u00e1gina.")}});currentPage++}}else return!1})}};h.scrollToTop();h.infinityScroll();return c};
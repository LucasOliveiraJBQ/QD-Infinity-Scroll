/**
* Vtex Smart Cart
* @author Carlos Vinicius
* @version 4.2
* @date 2012-10-02
*/
"function"!=typeof jQuery.fn.vtexPopUp2&&(jQuery.fn.vtexPopUp2=function(q){var e=jQuery(this);if(1>e.length)return e;var c=jQuery("body"),i=c.find(".boxPopUp2"),m="object"==typeof console;1>i.length&&(i=jQuery('<div class="boxPopUp2"><div class="boxPopUp2-wrap"><span class="boxPopUp2-close"></span><div class="boxPopUp2-content"></div></div></div>'),c.prepend(i),i.after('<div class="boxPopUp2-overlay"></div>'));var d=jQuery.extend({popupType:null,closeContent:null,popupClass:"",quickViewClass:".quickViewLink",
initCallback:function(){},showCallback:function(){},closeCallback:function(){}},q),q=i.find(".boxPopUp2-close"),k=i.find(".boxPopUp2-content"),u=c.find(".boxPopUp2-close, .boxPopUp2-overlay"),p=c.find(".boxPopUp2-overlay"),t=jQuery(document);null!=d.closeContent&&q.html(d.closeContent);var b={positioning:function(){var a=t.scrollTop(),b=jQuery(window).height(),c=i.outerHeight(!0);i.css("top",a+(c>=b?20:(b-c)/2)+"px")},show:function(a){a=a||{};p.fadeTo("fast",0.5,function(){i.show().addClass("popupOpened");
"boolean"===typeof a.loading&&!0===a.loading?b.showLoading():b.hideLoading();"function"===typeof a.callback&&a.callback();d.showCallback(i)})},hideLoading:function(){k.filter(":visible").css("background-image","none")},showLoading:function(){k.filter(":visible").css("background-image",'url("/arquivos/ajax-loader.gif")')},close:function(a){var a=a||{},b=function(){p.fadeOut("fast");i.fadeOut("fast",function(){k.empty()});k.attr("class","boxPopUp2-content");i.attr("class","boxPopUp2")};"boolean"==typeof a.closeNow&&
!0==a.closeNow&&b();1>u.filter(".boxPopUp2-clickActive").length&&(u.addClass("boxPopUp2-clickActive").bind("click",function(){"function"===typeof a.clickCallback?a.clickCallback():d.closeCallback(i);b()}),t.bind("keyup",function(a){27==(a.keyCode?a.keyCode:a.which)&&b()}));if(e.hasClass("autoClose")){var c=(e.attr("class")||"").split("ac_").pop().split(" ").shift();if(isNaN(parseFloat(c)))return m&&console.log("[Erro] O tempo informado (em segundos) n\u00e3o \u00e9 um valor num\u00e9rico: \u201c"+
c+"\u201d"),!1;setTimeout(function(){b()},1E3*c)}},setType:function(a){if(a.hasClass("quickViewLink"))b.quickView(a);else if(a.hasClass("giftListWrap"))b.giftList(a);else if(a.hasClass("installmentInfoTpl"))b.paymentForms(a);else if(a.hasClass("shipping-value"))b.calculateShipping(a);else if(a.hasClass("freeContent"))b.freeContent(a);else if(a.hasClass("boxPopUp2"))b.closeNow(a);else if(a.hasClass("referAFriendTpl"))b.productReferAFriend(a);else if(0<a.filter("#btnReferAFriend").length)b.giftListReferFriend(a);
else if(0<a.filter("#lnkPubliqueResenha").length)b.postRatingComment(a);else if(0<a.filter("#palerta").length)b.cartCheckoutAlert(a);else if(a.hasClass("lnkAddPhoto"))d.popupType="minhaContaFoto",b.userAccount(a);else return!1},checkType:function(a){"cadastroCliente"===d.popupType||"minhaContaFoto"===d.popupType?b.userAccount(a):"newsletter"===d.popupType?b.newsletter(a):"quickview"===d.popupType?b.quickView(a):"giftlist"===d.popupType?b.giftList(a):"paymentforms"===d.popupType?b.paymentForms(a):
"shipping"===d.popupType?b.calculateShipping(a):"string"==typeof d.popupType&&"freecontent"===d.popupType.toLowerCase()?b.freeContent(a):"closenow"===d.popupType?b.closeNow(a):"GiftListReferAFriend"===d.popupType?b.giftListReferFriend(a):"postRatingComment"===d.popupType?b.postRatingComment(a):b.freeContent(a)},exec:function(){e.each(function(){var a=$(this);null===d.popupType?b.setType(a):!1===b.checkType(a)&&b.setType(a)});d.initCallback()},userAccount:function(a){var c="";"cadastroCliente"===d.popupType?
c="signInPopups":"minhaContaFoto"===d.popupType&&(c="profilePhoto");a.unbind().removeAttr("onclick");var e=a.attr("href")||"";a.bind("mouseenter",function(){a.unbind().bind("click",function(){i.addClass(d.popupClass+" "+c+"Main");""===e&&m&&console.log("N\u00e3o existe URL no atributo href");jQuery('<iframe src="'+e+'" frameborder="0" allowtransparency="true"></iframe>').appendTo(k.addClass(d.popupClass+" "+c));b.show({loading:!0});b.positioning();b.close();return!1})})},newsletter:function(a){a.clone().appendTo(k.addClass(d.popupClass+
" newsletterPopup"));i.addClass(d.popupClass+" newsletterMain");b.show();b.positioning();b.close()},quickView:function(a){var a=c.find(d.quickViewClass),e=function(){a.filter(":not(.quickViewLinkActivated)").addClass("quickViewLinkActivated").bind("click",function(){jQuery('<iframe src="'+jQuery(this).attr("href")+'" frameborder="0" allowtransparency="true"></iframe>').appendTo(k.addClass(d.popupClass+" productQuickView"));i.addClass(d.popupClass+" quickViewMain");b.show({loading:!0});b.positioning();
b.close();return!1})};e();t.ajaxStop(e)},paymentForms:function(a){var e="",w=function(){var a=c.find(".see-other-payment-method-link");if(1>a.length)return m&&console.log("Url das formas de pagamento n\u00e3o encontrado. \n Verifique se o controle esta na p\u00e1gina.\n("+a.selector+")"),!1;e=/http:(.*?)(?=\&)/.exec(a[0].getAttribute("onclick").toString())[0]||"#onclickError"};w();a.bind("click",function(){jQuery("<iframe src='"+e+"' frameborder='0' allowtransparency='true'></iframe>").appendTo(k.addClass(d.popupClass+
" paymentFormsPopup"));i.addClass(d.popupClass+" paymentFormsMain");b.show({loading:!0});b.positioning();b.close();return!1});t.ajaxStop(w)},calculateShipping:function(){t.ajaxStop(function(){var a=c.find("#calculoFrete").children();if(1>a.length)return!1;a.find("span.cep-busca a").attr("target","_blank");a.appendTo(k.addClass(d.popupClass+" shippingCalculationPopup"));i.addClass(d.popupClass+" shippingCalculationMain");b.show();b.positioning();b.close()})},giftList:function(a){a.appendTo(k.addClass(d.popupClass+
" giftListPopup"));i.addClass(d.popupClass+" giftListMain");b.show();b.positioning();b.close({clickCallback:d.closeCallback})},cartCheckoutAlert:function(a){a.appendTo(k.addClass(d.popupClass+" cartCheckoutAlertPopup"));i.addClass(d.popupClass+" cartCheckoutAlertMain");b.show();b.positioning();b.close()},freeContent:function(a){a.appendTo(k.addClass(d.popupClass+" freeContentPopup"));i.addClass(d.popupClass+" freeContentMain");b.show();b.positioning();b.close()},closeNow:function(){b.close({closeNow:!0})},
giftListReferFriend:function(a){var c=function(){var a=$(this).attr("href");if("undefined"===typeof a||""===a)return m&&console.log("[Erro] Url do popup n\u00e3o encontrada."),!1;k.addClass(d.popupClass+" freeContentPopup").load(a);i.addClass(d.popupClass+" giftListReferFriendMain");b.show({loading:!0});b.positioning();b.close();return!1},e=function(){a.unbind().bind("mouseenter",function(){a.unbind().bind("click",c)})};e();t.ajaxStop(e)},productReferAFriend:function(a){var c=jQuery('<div class="referAFriendPopUpWrap"></div>');
a.bind("click",function(){var a=(jQuery(this).parent().find("#div-referAFriend input").attr("onclick")||"").toString(),a=/\/referAFriend\/Form\/[0-9]+\?/i.exec(a);if(null===a)return alert("Desculpe, n\u00e3o foi poss\u00edvel abrir o formul\u00e1rio."),!1;c.empty().load(a[0],function(){b.positioning()});c.appendTo(k.addClass(d.popupClass+" freeContentPopup"));i.addClass(d.popupClass+" freeContentMain");b.show();b.positioning();b.close();return!1});t.ajaxStop(function(){0<k.find(".referAFriendPopUpWrap #btnFechar").length&&
setTimeout(b.closeNow,1500)})},postRatingComment:function(a){var a=a.filter(":not(.popUpPublishReviewActivated)"),c=!1;if(1>a.length)return!1;a.bind("click",function(){var a=jQuery(this).attr("href")||"";if(""===a)return m&&console.log("[Erro] N\u00e3o foi poss\u00edvel obter os dados para abrir o popup de resenha."),!1;a=a.split(")").shift().split("(").pop().split(",");if(3!=a.length)return m&&console.log("[Erro] O array com os dados do cliente retornou um valor inesperado."),!1;if(c)return!1;c=
!0;jQuery.ajax({url:"/publishuserreviewcomment",type:"POST",data:{productId:a[1],clientId:a[0],categoryId:a[2]},success:function(a){var e=jQuery(a);k.addClass(d.popupClass+" userReviewPopup").html(e);i.addClass(d.popupClass+" userReviewPopupMain");b.show({callback:function(){e.find("#txtTituloResenha:hidden").val("titulo_auto");var a=k.find("a#rtAvaliacao_A0"),c=function(){a.attr("title",a.find(".filledRatingStar:last").index()+1||0)};a.find("span").bind("mouseenter",c);a.bind("mouseleave",c)}});
b.positioning();b.close();c=!1},error:function(){c=!1}});return!1}).addClass("popUpPublishReviewActivated");0==jQuery.fn.vtexPopUp2.data.userReviewCount&&t.ajaxStop(function(){k.hasClass("userReviewPopup")&&0==k.find(".formUserComment").children().length&&b.closeNow()});jQuery.fn.vtexPopUp2.data.userReviewCount++}};b.exec();return e},jQuery.fn.vtexPopUp2.data={userReviewCount:0});
(function(q){q.fn.getAttributes=function(){var e={},c=q(this).first();if(!c.length)return this;q.each(c[0].attributes,function(c,m){e[m.name]=m.value});return e}})(jQuery);"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});"function"!=typeof String.prototype.capitalize&&(String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1).toLowerCase()});var vtexscCartHideTimeOut=0;
jQuery.fn.smartCart=function(q){var e=function(h,a){"object"==typeof console&&console.log("[Smart Cart - "+(a||"Erro")+"] "+h)},c=jQuery.extend({method:1,htmlFormat:2,skuThumbId:3,cartElem:".vtexsc-cart",listElem:".vtexsc-productList",scrollTop:".vtexsc-arrowTop",scrollDown:".vtexsc-arrowBottom",btnOverlayElem:".vtexsc-buttonOverlay",errorElem:".vtexsc-error",successElem:".vtexsc-success",showCartBtn:".vtexsc-showCart",totalCart:".vtexsc-totalCart",buyButton:".vtexsc-buyButton",asynchronousClass:"btn-add-buy-button-asynchronous",
qttText:"",textRemove:"",textMoreOne:"",textMinusOne:"",firstOptionMsg:"Selecione um(a) ",ajaxErroMsg:"Houve um erro ao tentar adicionar/alterar seu produto no carrinho.",changeQttError:"Provavelmente esta altera\u00e7\u00e3o n\u00e3o obteve \u00eaxito!",skuNotSelected:"Selecione o(a) #groupName",skuNotLocated:"N\u00e3o foi poss\u00edvel obter as informa\u00e7\u00f5es das varia\u00e7\u00f5es deste produto.\nVoc\u00ea ser\u00e1 redirecionado para a p\u00e1gina de detalhes deste produto.",skuUnavailable:"Esta varia\u00e7\u00e3o de produto n\u00e3o esta disponp\u00edvel no momento.",
regularPricePopupHtml:'<div class="regularPrice">De: <span>R$ #regularPrice</span></div>',newPricePopupHtml:'<div class="newPrice">Por: <span>R$ #newPrice</span></div>',installmentPricePopupHtml:'<div class="installmentPrice">ou em at\u00e9 <span>#installmentQtt</span>X de <span>R$ #installmentValue</span> sem juros</div>',fullPricePopupHtml:'<div class="fullPrice">\u00e0 vista</div>',currency:"R$",notAjaxStop:!1,callback:function(){},ajaxCallback:function(){},succesShow:function(h){h.show()},cartShow:function(h,
a){h.slideDown(a)},cartHide:function(h,a){clearTimeout(vtexscCartHideTimeOut);vtexscCartHideTimeOut=setTimeout(function(){a(h)},5E3)},resetNewItem:function(h){setTimeout(function(){h.removeClass("vtexsc-newItem")},2500)},getSkuHtml:function(h){return h.find("ul.topic")},formatSkuPopup:function(h,a,c,b){var j,f,n,d,l;j=jQuery('<div class="skuWrap_"><div class="selectSkuTitle">Selecione a varia\u00e7\u00e3o do produto</div></div>');l=jQuery('<div class="vtexsm-prodTitle"></div>');f=jQuery('<div class="skuListWrap_"></div>');
n=jQuery('<div class="vtexsc-buttonWrap clearfix"><a href="#" class="vtexsc-buyButton"></a></div>');d=jQuery('<div class="vtexsc-skusWrap"></div>');jQuery("div");h.appendTo(f);a.appendTo(d);f.appendTo(d);c.appendTo(d);l.append(b);l.appendTo(j);d.appendTo(j);n.appendTo(j);return j}},q),i=jQuery(this),m=jQuery(""),d=jQuery(c.cartElem),k=!0,q=!1,u={};1>i.length&&0<d.length&&(q=!0,k=!1);if(1>i.length&&k)return i;if(1>d.length&&k)return e("Elemento do carrinho n\u00e3o encontrado \n ("+d.selector+")"),
!1;var p=d.find(c.listElem);if(1>p.length&&k)return e("Lista de produtos n\u00e3o encontrada \n ("+p.selector+")"),!1;jQuery(c.errorElem);var t=jQuery(c.successElem)||m,b=jQuery(c.showCartBtn)||m,a={},E=d.find(c.scrollDown)||m,w=d.find(c.scrollTop)||m,k=jQuery(c.totalCart)||m,D=jQuery("<span class='vtexsc-text'></span>"),y=jQuery("<div class='vtexsc-overlay'></div>"),z=m,x,A;k.children(".vtexsc-overlay").length||k.append(y);A=k.children(".vtexsc-text");A.length?x=A:(k.append(D),x=D);var g={buyButtons:function(){i.not(".vtexsm_activated").each(function(){var h=
jQuery(this);!h.hasClass("actionActivated")&&g.buyAsynchronous(h)&&h.addClass("actionActivated").bind("click",function(){if(-1<(h.attr("href")||"").indexOf("elecione"))return!0;var a=g.getSku(h);""!==a?g.skuToCart(h,a):e("O Sku n\u00e3o foi obtido! A execu\u00e7\u00e3o parou");return!1})}).addClass("vtexsm_activated")},buyAsynchronous:function(a){if(!a.hasClass(c.asynchronousClass))return!0;a.unbind("click").removeClass(c.asynchronousClass).addClass("asynchronousBuyButton");if(a.hasClass("remove-href"))return!0;
g.multiplesSkus(a);return!1},multiplesSkus:function(a){a.bind("click",function(){var s,v,b,j;s=a.attr("href")||"";if(""==s)return e("N\u00e3o foi poss\u00edvel obter a URL para a p\u00e1gina do produto \n m\u00e9todo: multiplesSkus"),!1;v=a.siblings(c.btnOverlayElem).show();b=jQuery('<div class="vtexsc-skuProductImage"></div>');j=jQuery('<div class="vtexsc-skuProductPrice"></div>');g.skuProductImg(b,a);jQuery.ajax({url:s,success:function(c){g.productSuccess(c,s,v,b,j,a)},error:function(){e("Erro ao requisitar a p\u00e1gina do produto via Ajax")}});
return!1})},skuProductImg:function(a,s){g.getParent(s,"li").find("a[href$='/p'] img").first().clone().appendTo(a)},getParent:function(a,s){var c;c=a.parent();return c.is("html")?jQuery(""):c.is(s)?c:c.length?g.getParent(c,s):c},productSuccess:function(a,s,b,d,j,f){var n,r,l;n=jQuery(a);a=c.getSkuHtml(n);r=!1;l=null;n.filter("script:not([src])").each(function(){var a=this.innerHTML;if(-1<a.indexOf("myJSONSkuSpecification"))return a=a.replace(":,",':"",').replace(":}",':""}').replace(":]",':""]'),eval(a),
l=myJSONSkuSpecification,r=!0,!1});if(!r)return e("N\u00e3o foi poss\u00edvel localizar as especifica\u00e7\u00f5es do SKU. \n A p\u00e1gina ser\u00e1 redirecionada!"),setTimeout(function(){document.location.href=s},500),!1;f=g.getParent(f,"li");n=f.find("a:first").attr("title");f="undefined"!=typeof n&&""!=n?n:f.find("a:eq(1)").text();c.formatSkuPopup(a,d,j,f).addClass("freeContent vtexsc-selectSku").vtexPopUp2({popupClass:"vtexsm-popupContent"});l=g.specificationsReorder(l);z=jQuery(c.buyButton)||
m;f=a.find("[type=checkbox]");n=a.find("select.sku-selector");if(0<f.length)tempChks=jQuery(""),f.each(function(){var a=jQuery(this),h=a.getAttributes(),h=jQuery('<input type="radio" name="'+h.name+'" specification="'+(h.specification||"")+'" class="'+(h["class"]||"")+'" id="'+(h.id||"")+'" value="'+h.value+'" />');a.after(h);a.remove();tempChks=tempChks.add(h)}),f=tempChks,b.hide(),1<l.specifications?g.multipleSkuConfigCheckbox(a,l,f,d,j):g.skuConfigCheckbox(a,l,f,d,j),g.buyButtonCheckbox(f,l,a,
s,b);else if(0<n.length){if(1<n.length)return e("Este plugin ainda n\u00e3o suporta mais de 1 selectbox.");b.hide();g.skuConfigSelectbox(a,l,n,d,j);g.buyButtonSelectbox(n,l,a,s,b)}else e("Elemento n\u00e3o previsto")},skuConfigSelectbox:function(a,s,b,d,j){var f,a=b.find("option:first");f=b.parent().siblings(".specification");""==a.text().trim()&&""!=c.firstOptionMsg&&a.text(c.firstOptionMsg+f.text().capitalize());b.change(function(){""!=$(this).val()&&g.actionsBySku(s,$(this).val(),d,j)})},buyButtonSelectbox:function(a,
c,b,d,j){z.bind("click",function(){var f,d,r;d=a.val();if(""==d)return alert("Selcione a especifica\u00e7\u00e3o \u201c"+b.find(".specification").text()+"\u201d"),!1;if("undefined"==typeof c.skus[d])return e("N\u00e3o foi poss\u00edvel obter o SKU na lista de especifica\u00e7\u00f5es");f=c.skus[d];r=function(c){c.Availability?(g.skuToCart(m,c.Id,void 0,j),jQuery(".boxPopUp2").vtexPopUp2()):alert("A especifica\u00e7\u00e3o \u201c"+a.find("[value="+d+"]").text()+"\u201d esta indispon\u00edvel.")};"object"==
typeof u[f]?r(u[f][0]):jQuery.ajax({url:"/produto/sku/"+f,data:"json",success:function(a,h,c){"object"!==typeof a?e("Erro ao obter informa\u00e7\u00f5es do sku \u201c"+f+"\u201d."):0!=c.status?(obj=a[0],u[obj.Id]=a,r(obj)):e("Erro ao obter informa\u00e7\u00f5es do sku \u201c"+f+"\u201d.")},error:function(){e("Erro ao obter informa\u00e7\u00f5es do sku \u201c"+f+"\u201d.")}});return!1})},buyButtonCheckbox:function(a,b,d,e,j){z.bind("click",function(){var f=a.filter(":checked");if(2>b.specifications)0<
f.length?(f=b.skus[f.val()],"undefined"===typeof f?(alert(c.skuNotLocated),document.location.href=e):"False"===f[1]?alert(c.skuUnavailable):(g.skuToCart(m,f[0],void 0,j),jQuery(".boxPopUp2").vtexPopUp2())):(f=d.find(".specification").eq(0).text()||" varia\u00e7\u00e3o do produto",alert(c.skuNotSelected.replace("#groupName",f)));else{var n=!1;d.each(function(){var a=jQuery(this);if(1>a.find("input:checked").length)return a=d.find(".specification").eq(a.index()).text()||" varia\u00e7\u00e3o do produto",
alert(c.skuNotSelected.replace("#groupName",a)),n=!0,!1});if(!n){var r=[];f.each(function(){r.push(jQuery(this).val())});f=b.skus[r.join(",")];"undefined"===typeof f?(alert(c.skuNotLocated),document.location.href=e):"False"===f[1]?alert(c.skuUnavailable):(g.skuToCart(m,f[0],void 0,j),jQuery(".boxPopUp2").vtexPopUp2())}}return!1})},specificationsReorder:function(a){var c={};"undefined"!==typeof a.specifications?c.specifications=a.specifications:e("N\u00e3o foi localizado o item \u201cspecifications\u201d do objeto com as especifica\u00e7\u00f5es de SKU.");
if("undefined"!==typeof a.combination){var b=a.combination.length;c.combination={};for(var d=0;d<b;d++)for(var j in a.combination[d])if("string"===typeof a.combination[d][j])c.combination[j]=a.combination[d][j].split(",");else for(var f in a.combination[d][j][0]){c.combination[j]=a.combination[d][j][0][f].split(",");break}}else e("N\u00e3o foi localizado o item \u201ccombination\u201d do objeto com as especifica\u00e7\u00f5es de SKU.");if("undefined"!==typeof a.skus){b=a.skus.length;c.skus={};for(d=
0;d<b;d++)for(j in a.skus[d])c.skus[j]=a.skus[d][j].split(",")}else e("N\u00e3o foi localizado o item \u201cskus\u201d do objeto com as especifica\u00e7\u00f5es de SKU.");return c},getSku:function(a){return a.hasClass("asynchronousBuyButton")?(a.attr("id")||"").replace("idprod",""):(a.attr("href")||"").split("dSku=")[1]||""},selectUniqueSku:function(a){a.each(function(){var a,c;a=$(this);c=a.find("input");1==c.length&&(c.attr("checked",!0).trigger("change").trigger("click"),a.hide())})},multipleSkuConfigCheckbox:function(a,
c,b,d,j){2<c.specifications&&e("Esta exten\u00e3o n\u00e3o foi testada com mais de dois tipos de SKUs","Alerta");a.filter(":first").find("input").each(function(){var a=jQuery(this),b=a.val(),d,h,j=!0;if("undefined"!=typeof b&&""!=b&&(d=c.combination[b],"undefined"!=typeof d)){h=d.length;for(var g=0;g<h;g++)"object"==typeof c.skus[b+","+d[g]]&&"True"==c.skus[b+","+d[g]][1]&&(j=!1);j&&a.addClass("item_unavaliable").next("label").addClass("item_unavaliable")}});b.bind("change",function(){var b,n,e;b=
jQuery(this);e=b.attr("id").split("_");n=e[1]||e.pop();a.not(":eq("+n+")").find("input").each(function(){var a=jQuery(this),h;h="0"==n?b.val()+","+a.val():a.val()+","+b.val();"object"==typeof c.skus[h]&&(b.is(":checked")&&a.is(":checked"))&&g.actionsBySku(c,h,d,j);"object"==typeof c.skus[h]&&"False"==c.skus[h][1]&&(a.addClass("item_unavaliable").next("label").addClass("item_unavaliable"),b.addClass("item_unavaliable").next("label").addClass("item_unavaliable"))})});g.selectUniqueSku(a);a.find("input").length<=
a.length&&e("Deve ser desenvolvida uma fun\u00e7\u00e3o p/ varia\u00e7\u00f5es de SKUs em que todas tem apenas uma op\u00e7\u00e3o","Aviso")},actionsBySku:function(a,b,d,i){var j,f,n,r,l,k,m,p,B,C;j=d.find("img");1>j.length&&(j=jQuery('<img src="" alt="" />'),d.append(j));f=a.skus[b][0];C=function(a){n=g.getImageUrl(a,c.skuThumbId);"string"==typeof n[0]?j.attr("src",n[0]):e("[2] N\u00e3o foi poss\u00edvel obter a imagem p/ o sku \u201c"+f+"\u201d.");l=jQuery(c.regularPricePopupHtml.replace("#regularPrice",
g.numberFormat(a.ListPrice))).hide();k=jQuery(c.newPricePopupHtml.replace("#newPrice",g.numberFormat(a.Price)));p=jQuery(c.installmentPricePopupHtml.replace("#installmentQtt",a.BestInstallmentNumber).replace("#installmentValue",g.numberFormat(a.BestInstallmentValue))).hide();B=jQuery(c.fullPricePopupHtml).hide();m=jQuery("").add(l).add(k).add(p).add(B);a.Price<a.ListPrice&&l.show();1<a.BestInstallmentNumber?p.show():B.show();i.html(m)};"object"==typeof u[f]?C(u[f][0]):jQuery.ajax({url:"/produto/sku/"+
f,data:"json",success:function(a,c,b){"object"!==typeof a?e("[1] N\u00e3o foi poss\u00edvel obter a imagem p/ o sku \u201c"+f+"\u201d."):0!=b.status?(r=a[0],u[r.Id]=a,C(r)):e("[3] N\u00e3o foi poss\u00edvel obter a imagem p/ o sku \u201c"+f+"\u201d.")},error:function(){e("N\u00e3o foi poss\u00edvel obter a imagem p/ o sku \u201c"+f+"\u201d.")}})},numberFormat:function(a){var c="",b="",c="",d,j,a=a.toFixed(2).split("."),b=a[0].split("");d=0;j=b.length;for(var f=a[0].length;0<f;f--)b=a[0].substr(f-
1,1),d++,0==d%3&&j>d&&(b="."+b),c=b+c;return c=c+","+a[1]},getImageUrl:function(a,c){var b=[];if(1>a.Images.length)return e("N\u00e3o foram encontradas imagens para o SKU: "+a.Id,"Alerta"),b;for(array in a.Images)for(img in a.Images[array])if(a.Images[array][img].ArchiveTypeId==c){b.push(a.Images[array][img].Path);break}return b},skuConfigCheckbox:function(a,c,b,d,j){a.each(function(){var f=jQuery(this),e=f.find("[type=radio]"),i;for(i in c.skus)"False"===c.skus[i][1]&&e.filter("[value='"+i+"']").addClass("item_unavaliable").next("label").addClass("item_unavaliable");
e.bind("change",function(){var l,i,k,m;m=1<c.specifications;l=jQuery(this);i=[];e.not(l).attr("checked",!1);k=l.val()||"_";"object"==typeof c.skus[k]&&l.is(":checked")&&g.actionsBySku(c,k,d,j);if(l.is(":checked")){if(b.removeClass("sku-picked").next("label").removeClass("sku-picked"),l.addClass("sku-picked").next("label").addClass("sku-picked"),m){var r=[(l.attr("name")||"").replace("espec_",""),l.val()||""];a.not(f).each(function(){var a=[];jQuery(this).find("[type=radio]").each(function(){a[r[0]]=
r[1];a[(this.attr("name")||"").replace("espec_","")]=this.val()||"";i.push(a)})})}}else l.removeClass("sku-picked").next("label").removeClass("sku-picked"),m&&b.removeClass("item_unavaliable").next("label").removeClass("item_unavaliable")})})},skuToCart:function(a,b,d,i){d=d||1;if(isNaN(parseInt(b)))return e("O SKU n\u00e3o \u00e9 um n\u00famero: \u201c"+b+"\u201d"),!1;if(isNaN(parseInt(d)))return e("A quantidade deve ser num\u00e9rica: \u201c"+d+"\u201d"),!1;var j=i||a.siblings(c.btnOverlayElem);
j.show();jQuery.ajax({url:"/Site/Carrinho.aspx?idSku="+b+"&quantidade="+d,success:function(a){g.skuToCartAjaxSuccess(j,b,a);g.updateCart()},error:function(){g.skuToCartAjaxError(j)}})},loadCart:function(a){(a||!d.hasClass("preLoaded"))&&jQuery.ajax({url:"/Site/Carrinho.aspx",success:function(a){g.skuToCartAjaxSuccess(m,0,a,!1);d.addClass("preLoaded");g.scrollAction()},error:function(){g.skuToCartAjaxError(m)}})},skuToCartAjaxSuccess:function(a,b,d,e){a.hide();if(-1<d.indexOf("Ocorreu um erro"))return g.skuToCartAjaxError();
a=jQuery(d);c.succesShow(t);switch(c.htmlFormat){case 1:g.formatCartItens(a,b);break;case 2:g.formatCartItens2(a,b)}("undefined"!==typeof e?e:1)&&g.displayCart();c.ajaxCallback()},skuToCartAjaxError:function(a){a.hide();e("A requisi\u00e7\u00e3o Ajax para adicionar/alterar o SKU no carrinho \n n\u00e3o obteve a resposta esperada. \n Foi retornado um texto contendo o termo \u201cOcorreu um erro\u201d.");alert(c.ajaxErroMsg);return!1},formatCartItens:function(b,d){var e=b.find(".carrinhoTable"),i=0;
if(1>e.length)return!1;e.find("tbody tr").each(function(){var b=jQuery("<li></li>"),f=jQuery(this),e=jQuery('<div class="cartSkuImage"></div>');f.find(".sku-imagem").appendTo(e);e.appendTo(b);var e=jQuery('<div class="cartSkuInfo"></div>'),h=f.find(".boxQuantidade"),l=h.attr("title")||"";a=parseInt(h.val());f.find("h4").appendTo(e);e.append('<div class="cartSkuUnitPrice">'+(f.find(".preco-unitario").html()||"").toString()+"</div>");var h=jQuery('<div class="cartSkuQtt"><span class="cartSkuQttTxt">'+
c.qttText+'<span class="vtexsc-skuQtt">'+(a||"")+"</span></span></div>"),k=h.find(".vtexsc-skuQtt");e.append(h);e.appendTo(b);e=jQuery('<div class="cartSkuActions"></div>');jQuery('<span class="cartSkuRemove">'+c.textRemove+"</span>").bind("click",function(){g.removeSku(b,(f.find("a.excluir").attr("href")||"").split("IdSkuRm=").pop())}).appendTo(e);var m=jQuery('<span class="cartSkuMoreOne">'+c.textMoreOne+"</span>").bind("click",function(){var c=g.changeQantity([b,k],l,a);isNaN(c)||(a=c)}),v=jQuery('<span class="cartSkuMinusOne">'+
c.textMinusOne+"</span>").bind("click",function(){var c=g.changeQantity([b,k],l,a,-1);isNaN(c)||(a=c)}),q=jQuery('<span class="cartSkuChangeQttWrap"></span>');q.append(m).append(v);h.append(q);e.append(q.clone());e.appendTo(b);"undefined"!==typeof d&&l==d&&c.resetNewItem(b.addClass("vtexsc-newItem"));0===i&&p.empty();b.append("<div class='vtexsc-overlay'></div>");b.appendTo(p);i++})},formatCartItens2:function(b,d){var e=b.find(".carrinhoTable"),i=0;if(1>e.length)return!1;e.find("tbody tr").each(function(){var b=
null,e=jQuery(this),h=jQuery("<tr></tr>");h.addClass(e.attr("class")||"");b=jQuery('<td class="cartSkuImage"></td>');e.find(".sku-imagem").appendTo(b);b.appendTo(h);b=jQuery('<td class="cartSkuName"></td>');e.find("h4").appendTo(b);b.appendTo(h);b=jQuery('<td class="cartSkuPrice"></td>');b.append('<div class="cartSkuUnitPrice">'+(e.find(".preco-unitario").html()||"").toString()+"</div>");b.appendTo(h);var b=jQuery('<td class="cartSkuQunatity"></td>'),k=e.find(".boxQuantidade"),l=k.attr("title")||
"";curQtt=parseInt(k.val());var k=jQuery('<div class="cartSkuQtt"><span class="cartSkuQttTxt">'+c.qttText+'<span class="vtexsc-skuQtt">'+(curQtt||"")+"</span></span></div>"),m=k.find(".vtexsc-skuQtt");b.append(k);b.appendTo(h);a["_"+l]=curQtt;b=jQuery('<td class="cartSkuActions"></td>');remove=jQuery('<span class="cartSkuRemove">'+c.textRemove+"</span>").bind("click",function(){g.removeSku(h,(e.find("a.excluir").attr("href")||"").split("IdSkuRm=").pop())}).appendTo(b);var v=jQuery('<span class="cartSkuMoreOne">'+
c.textMoreOne+"</span>").bind("click",function(){var b=g.changeQantity([h,m],l,a["_"+l]);isNaN(b)||(a["_"+l]=b)}),q=jQuery('<span class="cartSkuMinusOne">'+c.textMinusOne+"</span>").bind("click",function(){var b=g.changeQantity([h,m],l,a["_"+l],-1);isNaN(b)||(a["_"+l]=b)}),t=jQuery('<span class="cartSkuChangeQttWrap"></span>');t.append(v).append(q);k.append(t);b.append(t.clone());b.appendTo(h);"undefined"!==typeof d&&l==d&&c.resetNewItem(h.addClass("vtexsc-newItem"));0===i&&p.empty();h.find(">td").append("<div class='vtexsc-overlay'></div>");
h.appendTo(p);i++});g.totalCartFormat(e)},totalCartFormat:function(a){x.html(a.find("tfoot .subtotal .preco-total").text())},scrollNewItem:function(){p.parent().stop(!0,!0).animate({scrollTop:p.height()||0},"fast")},updateCart:function(){y.show();jQuery.ajax({url:"/no-cache/QuantidadeItensCarrinho.aspx",success:g.upCartAjaxSuccess,error:g.upCartAjaxError})},upCartAjaxError:function(){e("Erro ao tentar atualizar o carrinho!")},upCartAjaxSuccess:function(a){var b,a=jQuery(a);b=a.find(".total-cart").text();
x.text("R$ "+b.substring(b.search(/\d/)));a=a.filter(".cartInfoWrapper");0<a.length?jQuery(".cartInfoWrapper").html(a.html()):e("[Erro] O carrinho n\u00e3o foi atualizado pois \u201c.cartInfoWrapper\u201d n\u00e3o foi encontrado no retorno da requisi\u00e7\u00e3o.");y.hide()},displayCart:function(){c.cartShow(d,g.scrollNewItem);c.cartHide(d,g.hideCart)},removeSku:function(a,b){var d=b||"";if(isNaN(parseInt(d)))return e("O SKU deve ser num\u00e9rico: \u201c"+d+"\u201d"),!1;var i=a.find(".vtexsc-overlay").show()||
m;jQuery.ajax({url:"/no-cache/CarrinhoRemove.aspx?IdSkuRm="+d,success:function(){2===c.htmlFormat?a.hide(function(){g.scrollAction()}).remove():a.slideUp(function(){g.scrollAction();jQuery(this).remove()});i.hide();g.updateCart()}})},scrollAction:function(){d.filter(":hidden").addClass("calculatingTheHeight").css("visibility","hidden").show();var a=p.parent();2===c.htmlFormat?(a.height(),p.find("tr:visible")):(a.height(),p.children().filter(":visible"));d.filter(".calculatingTheHeight").removeClass("calculatingTheHeight").hide().css("visibility",
"visible");E.unbind("click").bind("click",function(){var b=p.find("tr:first"),b=0<b.length?b:p.find("li:first");a.stop(!0,!0).animate({scrollTop:"+="+b.outerHeight(!0)+"px"},"fast")});w.unbind("click").bind("click",function(){var b=p.find("tr:first"),b=0<b.length?b:p.find("li:first");a.stop(!0,!0).animate({scrollTop:"-="+b.outerHeight(!0)+"px"},"fast")})},changeQantity:function(b,d,e,i){var j=i||1;if(2>e&&0>j)return e;var f=b[0].find(".vtexsc-overlay").show()||m,e=e+j;jQuery.ajax({url:"/no-cache/CarrinhoUpdate.aspx?IdSku="+
d+"&quantidade="+e,success:function(i){f.hide();if(-1<i.indexOf("Ocorreu um erro"))return g.skuToCartAjaxError(m);0<jQuery(i).filter(".cart-items-detail").length?(alert(c.changeQttError),a["_"+d]=e-j):b[1].text(e);g.updateCart()},error:function(){g.skuToCartAjaxError(m)}});return e},hideCart:function(a){a.slideUp()},mouseCartActions:function(){var a={mouseenter:function(){clearTimeout(vtexscCartHideTimeOut);c.cartShow(d,function(){})},mouseleave:function(){c.cartHide(d,g.hideCart)}};d.filter(":not(.mouseActivated)").bind(a).addClass("mouseActivated");
b.filter(":not(.mouseActivated)").bind(a).addClass("mouseActivated")},onlyCart:function(){g.loadCart();g.mouseCartActions()}};if(q)g.onlyCart();else{switch(c.method){case 1:g.buyButtons()}g.loadCart();g.mouseCartActions();c.callback()}return i};